!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():t.mitty=n()}(this,function(){var o=0,t={on:function(t,n){return e(this,this,t,n),this},once:function(t,n){return e(this,this,t,n,!0),this},listenTo:function(t,n,i){return e(t,this,n,i),this},listenToOnce:function(t,n,i){return e(t,this,n,i,!0),this},off:function(t,n){return s(this,t,n),this},stopListening:function(t,n,i){return u(this,t,n,i),this},trigger:function(t,n){var i,e,r;return e=t,r=n,(i=this)._mittyOn&&i._mittyOn.slice().forEach(function(t){t.eventName===e&&(t.callback.call(t.listener,r),t.runOnce&&(t.listener===t.publisher?s(t.publisher,e,t.callback):u(t.listener,t.publisher,e,t.callback)))}),this}};function e(t,n,i,e,r){var s="e"+ ++o,u={key:s,publisher:t,listener:n,eventName:i,callback:e,runOnce:r};t._mittyOn=t._mittyOn||[],t._mittyOn.push(u),t!==n&&(n._mittyListenTo=n._mittyListenTo||{},n._mittyListenTo[s]=u)}function s(t,i,e){t._mittyOn&&(t._mittyOn=t._mittyOn.filter(function(t){var n=!(i&&i!==t.eventName||e&&e!==t.callback);return n&&t.listener!==t.publisher&&delete t.listener._mittyListenTo[t.key],!n}))}function u(i,e,r,s){i._mittyListenTo&&n(i._mittyListenTo,function(t,n){!(e&&e!==n.publisher||r&&r!==n.eventName||s&&s!==n.callback)&&(n.publisher._mittyOn=n.publisher._mittyOn.filter(function(t){return t!==n}),delete i._mittyListenTo[t])})}function n(t,n){for(var i in t)t.hasOwnProperty(i)&&n(i,t[i])}return function(i){return n(t,function(t,n){i[t]=n}),i}});